{% extends "./loan_base.html" %}

{% block sidebar %}
  <a href="{% url 'loans:all_loan_applications' %}" class="back-link">‚Üê Back to All Applications</a>
{% endblock sidebar %}
{% block content %}
  <div class="loan-landing">
    <h1>Deposit Loan Application</h1>
    <p class="subtitle">Get help with your property deposit to secure your dream home</p>
    <div class="action-section">
      <a href="{% url 'loans:deposit_loan_application_start' %}"
         class="btn btn-primary">Start New Application</a>
    </div>
    <div class="loan-info">
      <h2>About Deposit Loans</h2>
      <p>
        Our Deposit Loans help you bridge the gap between your savings and the deposit
        required to purchase a property. Whether you're a first home buyer or an experienced
        investor, we can help you get into your next property sooner.
      </p>
      <div class="highlight-box">
        <strong>Perfect for first home buyers:</strong> We understand the challenges of
        getting onto the property ladder. Our deposit loans are designed to help make
        homeownership a reality.
      </div>
      <h2>What You Can Use It For:</h2>
      <ul>
        <li>House and apartment deposits</li>
        <li>First home purchases</li>
        <li>Investment property deposits</li>
        <li>Bridging finance for property upgrades</li>
        <li>Auction deposits and settlement funds</li>
      </ul>
      <p>
        <strong>Loan amounts:</strong> From $20,000 to $250,000
        <br />
        <strong>Application time:</strong> Approximately 5-10 minutes
      </p>
    </div>
    <div class="retrieval-section">
      <h3>Continue a Draft Application</h3>
      <p>Already started an application? Enter your details below to continue where you left off.</p>
      {% if messages %}
        {% for message in messages %}
          <div class="alert alert-{{ message.tags }} alert-dismissible fade show"
               role="alert">
            {{ message }}
            <button type="button"
                    class="btn-close"
                    data-bs-dismiss="alert"
                    aria-label="Close"></button>
          </div>
        {% endfor %}
      {% endif %}
      <form method="post" class="retrieval-form">
        {% csrf_token %}
        <div class="form-group">
          <label for="{{ retrieval_form.customer_email.id_for_label }}">Email Address</label>
          {{ retrieval_form.customer_email }}
        </div>
        <div class="form-group">
          <label for="{{ retrieval_form.customer_date_of_birth.id_for_label }}">Date of Birth</label>
          {{ retrieval_form.customer_date_of_birth }}
        </div>
        <button type="submit" name="retrieve_application" class="btn-retrieve">Retrieve Application</button>
      </form>
      {% if draft_applications %}
        <div class="draft-applications">
          <h4>Recent Draft Applications</h4>
          <ul class="draft-list">
            {% for app in draft_applications %}
              <li>
                <div class="draft-info">
                  <strong>{{ app.first_name }} {{ app.last_name }}</strong>
                  <small>{{ app.customer_email }} | Started: {{ app.created_at|date:"M d, Y" }}</small>
                </div>
                <a href="{% url 'loans:deposit_loan_application_continue' pk=app.id %}"
                   class="btn-continue">Continue</a>
              </li>
            {% endfor %}
          </ul>
        </div>
      {% endif %}
    </div>
  </div>
{% endblock content %}
